version: '3.2'
services:
  sentiment_guesser:
    build: ../
    environment:
      - PORT=8123
    ports:
      - "8123:8123"
  cypress:
    image: "mtlynch/cypress:3.2.0"
    depends_on:
      - sentiment_guesser
    environment:
      - CYPRESS_baseUrl=http://sentiment_guesser:8123
    command: cypress run
    working_dir: /app
    volumes:
      - ./cypress:/app/cypress
      # Traverse in and out of the e2e directory so that docker-compose will
      # mount a single file as a volume.
      - ../e2e/cypress.json:/app/cypress.json
